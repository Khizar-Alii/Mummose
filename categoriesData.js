const categoryData = {
  Bowls: {
    1: {
      id: 1,
      title: "Beduin - Tahini",
      location: "Lorem Ipsum Johar Town",
      img: "/Assets/food1.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "80 SEK",
      toppings: [
        {
          id: 1,
          title: "Kyckling & soltorkade tomater",
          price: 75,
        },
        {
          id: 2,
          title: "Sucukkorv & paprika",
          price: 75,
        },
        {
          id: 3,
          title: "Halloumi & gurka",
          price: 75,
        },
        {
          id: 4,
          title: "Kokt ägg & avokado",
          price: 75,
        },
        {
          id: 5,
          title: "Champinjoner & timjan",
          price: 75,
        },
        {
          id: 6,
          title: "Rostade pinjenötter & mandlar",
          price: 75,
        },
      ],
    },
    2: {
      id: 2,
      title: "Daredevil - het chili",
      location: "Lorem Ipsum Johar Town",
      img: "/Assets/food1.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "80 SEK",
      toppings: [
        {
          id: 1,
          title: "Kyckling & soltorkade tomater",
          price: 75,
        },
        {
          id: 2,
          title: "Sucukkorv & paprika",
          price: 75,
        },
        {
          id: 3,
          title: "Halloumi & gurka",
          price: 75,
        },
        {
          id: 4,
          title: "Kokt ägg & avokado",
          price: 75,
        },
        {
          id: 5,
          title: "Champinjoner & timjan",
          price: 75,
        },
        {
          id: 6,
          title: "Rostade pinjenötter & mandlar",
          price: 75,
        },
      ],
    },
    3: {
      id: 3,
      title: "Bohemian - rödbeta",
      location: "Lorem Ipsum Johar Town",
      img: "/Assets/food1.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "80 SEK",
      toppings: [
        {
          id: 1,
          title: "Kyckling & soltorkade tomater",
          price: 75,
        },
        {
          id: 2,
          title: "Sucukkorv & paprika",
          price: 75,
        },
        {
          id: 3,
          title: "Halloumi & gurka",
          price: 75,
        },
        {
          id: 4,
          title: "Kokt ägg & avokado",
          price: 75,
        },
        {
          id: 5,
          title: "Champinjoner & timjan",
          price: 75,
        },
        {
          id: 6,
          title: "Rostade pinjenötter & mandlar",
          price: 75,
        },
      ],
    },
    4: {
      id: 4,
      title: "Genovese - pesto",
      location: "Lorem Ipsum Johar Town",
      img: "/Assets/food1.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "80 SEK",
      toppings: [
        {
          id: 1,
          title: "Kyckling & soltorkade tomater",
          price: 75,
        },
        {
          id: 2,
          title: "Sucukkorv & paprika",
          price: 75,
        },
        {
          id: 3,
          title: "Halloumi & gurka",
          price: 75,
        },
        {
          id: 4,
          title: "Kokt ägg & avokado",
          price: 75,
        },
        {
          id: 5,
          title: "Champinjoner & timjan",
          price: 75,
        },
        {
          id: 6,
          title: "Rostade pinjenötter & mandlar",
          price: 75,
        },
      ],
    },
    5: {
      id: 5,
      title: "Greek - vitlök & yogurt",
      location: "Lorem Ipsum Johar Town",
      img: "/Assets/food1.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "80 SEK",
      toppings: [
        {
          id: 1,
          title: "Kyckling & soltorkade tomater",
          price: 75,
        },
        {
          id: 2,
          title: "Sucukkorv & paprika",
          price: 75,
        },
        {
          id: 3,
          title: "Halloumi & gurka",
          price: 75,
        },
        {
          id: 4,
          title: "Kokt ägg & avokado",
          price: 75,
        },
        {
          id: 5,
          title: "Champinjoner & timjan",
          price: 75,
        },
        {
          id: 6,
          title: "Rostade pinjenötter & mandlar",
          price: 75,
        },
      ],
    },
    6: {
      id: 6,
      title: "Hippie - hela kikärtor & persilja",
      location: "Lorem Ipsum Johar Town",
      img: "/Assets/food1.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "80 SEK",
      toppings: [
        {
          id: 1,
          title: "Kyckling & soltorkade tomater",
          price: 75,
        },
        {
          id: 2,
          title: "Sucukkorv & paprika",
          price: 75,
        },
        {
          id: 3,
          title: "Halloumi & gurka",
          price: 75,
        },
        {
          id: 4,
          title: "Kokt ägg & avokado",
          price: 75,
        },
        {
          id: 5,
          title: "Champinjoner & timjan",
          price: 75,
        },
        {
          id: 6,
          title: "Rostade pinjenötter & mandlar",
          price: 75,
        },
      ],
    },
  },
  Wraps: {
    1: {
      id: 1,
      title: "Kycklingwrap",
      location: "Lorem Ipsum DHA",
      img: "/Assets/food2.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "pestohummus",
        "kycklingbröst",
        "sallad",
        "tomater",
        "basilika"
      ],
      serving: "1 servings per person",
      pricing: "99 SEK",
    },
    2: {
      id: 2,
      title: "Sucukkorvwrap",
      location: "Lorem Ipsum Gulberg",
      img: "/Assets/food3.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "beduinhummus",
        "korv",
        "ruccola",
        "stekt paprika",
        "rödlök"
      ],
      serving: "1 servings per person",
      pricing: "99 SEK",
    },
    3: {
      id: 3,
      title:   "Halloumiwrap",
      location: "Lorem Ipsum Gulberg",
      img: "/Assets/food3.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes:  [
        "rödbetshummus",
        "halloumi",
        "sallad",
        "inlagd gurka",
        "mynta"
      ],
      serving: "1 servings per person",
      pricing: "99 SEK",
    },
    4: {
      id: 4,
      title:   "Falafelwrap",
      location: "Lorem Ipsum Gulberg",
      img: "/Assets/food3.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "beduinhummus",
        "falafel",
        "mynta",
        "persilja",
        "tomater",
        "tahinissås",
        "inlagd gurka"
      ],
      serving: "1 servings per person",
      pricing: "99 SEK",
    },
  },
  Salads: {
    1: {
      id: 1,
      title: "Räksallad",
      location: "Lorem Ipsum Mall Road",
      img: "/Assets/food4.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "räkor",
        "avokado",
        "kokt ägg",
        "gurka",
        "körsbärstomater",
        "sallad"
      ],
      serving: "1 servings per person",
      pricing: "135 SEK",
    },
    2: {
      id: 2,
      title: "Caesarsallad med kyckling",
      location: "Lorem Ipsum Cantt",
      img: "/Assets/food5.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "kycklingbröst",
        "körsbärstomater",
        "krutonger",
        "parmesan",
        "sallad"
      ],
      serving: "1 servings per person",
      pricing: "135 SEK",
    },
    3: {
      id: 3,
      title: "Rucola- & fetaostsallad",
      location: "Lorem Ipsum Mall Road",
      img: "/Assets/food4.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "fetaost",
        "rödlök",
        "oliver",
        "körsbärstomater",
        "ruccola"
      ],
      serving: "1 servings per person",
      pricing: "135 SEK",
    },
    4: {
      id: 4,
      title: "Pastasallad",
      location: "Lorem Ipsum Cantt",
      img: "/Assets/food5.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "penne pasta",
        "halloumi",
        "paprika",
        "gurka",
        "majs",
        "pestosås",
        "körsbärstomater"
      ],
      serving: "1 servings per person",
      pricing: "135 SEK",
    },
  },
  Sides: {
    1: {
      id: 1,
      title: "Labneh",
      location: "Lorem Ipsum Town",
      img: "/Assets/food6.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      serving: "1 servings per person",
      pricing: "35 SEK",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
    },
    2: {
      id: 2,
      title: "Oliver",
      location: "Lorem Ipsum Center",
      img: "/Assets/food7.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      serving: "1 servings per person",
      pricing: "30 SEK",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
    },
  },
  Sweets: {
    1: {
      id: 1,
      title: "Halva",
      location: "Lorem Ipsum Town",
      img: "/Assets/food6.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "49 SEK",
    },
    2: {
      id: 2,
      title: "Baklava",
      location: "Lorem Ipsum Center",
      img: "/Assets/food7.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "59 SEK",
    },
  },
  "Hummus (gram)": {
    1: {
      id: 1,
      title: "Beduin",
      location: "Lorem Ipsum Heights",
      img: "/Assets/food10.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "35 SEK",
      grams: [
        {
          id: 1,
          title: "100 g",
          price: 75,
        },
        {
          id: 2,
          title: "200 g",
          price: 120,
        },
        {
          id: 3,
          title: "300 g",
          price: 200,
        },
      ],
    },
    2: {
      id: 2,
      title: "Daredevil",
      location: "Lorem Ipsum Street",
      img: "/Assets/food11.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "37 SEK",
      grams: [
        {
          id: 1,
          title: "100 g",
          price: 75,
        },
        {
          id: 2,
          title: "200 g",
          price: 120,
        },
        {
          id: 3,
          title: "300 g",
          price: 200,
        },
      ],
    },
    3: {
      id: 3,
      title: "Bohemian",
      location: "Lorem Ipsum Heights",
      img: "/Assets/food10.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "37 SEK",
      grams: [
        {
          id: 1,
          title: "100 g",
          price: 75,
        },
        {
          id: 2,
          title: "200 g",
          price: 120,
        },
        {
          id: 3,
          title: "300 g",
          price: 200,
        },
      ],
    },
    4: {
      id: 4,
      title: "Pesto",
      location: "Lorem Ipsum Street",
      img: "/Assets/food11.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "38 SEK",
      grams: [
        {
          id: 1,
          title: "100 g",
          price: 75,
        },
        {
          id: 2,
          title: "200 g",
          price: 120,
        },
        {
          id: 3,
          title: "300 g",
          price: 200,
        },
      ],
    },
    5: {
      id: 5,
      title: "Greek",
      location: "Lorem Ipsum Heights",
      img: "/Assets/food10.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "38 SEK",
      grams: [
        {
          id: 1,
          title: "100 g",
          price: 75,
        },
        {
          id: 2,
          title: "200 g",
          price: 120,
        },
        {
          id: 3,
          title: "300 g",
          price: 200,
        },
      ],
    },
    6: {
      id: 6,
      title: "Hippie",
      location: "Lorem Ipsum Street",
      img: "/Assets/food11.jpg",
      description:
        "Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptatem iusto atque ipsum quasi et quos neque dolorum praesentium doloribus animi.",
      notes: [
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
        "Lorem ipsum dolor sit amet consectetur adipisicing elit.",
      ],
      serving: "1 servings per person",
      pricing: "39 SEK",
      grams: [
        {
          id: 1,
          title: "100 g",
          price: 75,
        },
        {
          id: 2,
          title: "200 g",
          price: 120,
        },
        {
          id: 3,
          title: "300 g",
          price: 200,
        },
      ],
    },
  },
};

const categories = Object.keys(categoryData);
const categoriesContainer = document.querySelector(".categoriesContainer");
const categoryItemsContainer = document.querySelector(
  ".categoryItemsContainer"
);

// Function to render categories at the top
function renderCategories() {
  categoriesContainer.innerHTML = "";
  categories.forEach((category) => {
    const categoryItem = document.createElement("h1");
    categoryItem.textContent = category;
    categoryItem.classList.add("categoryItem");
    // Set "Bowls" as default active category
    if (category === "Bowls") categoryItem.classList.add("activeCat");

    categoryItem.addEventListener("click", () => setActiveCategory(category));
    categoriesContainer.appendChild(categoryItem);
  });
}

// Function to set active category and display data
function setActiveCategory(category) {
  document.querySelectorAll(".categoryItem").forEach((item) => {
    item.classList.remove("activeCat");
  });

  // Add active class to the selected category
  const activeCategory = [...categoriesContainer.children].find(
    (item) => item.textContent === category
  );
  activeCategory.classList.add("activeCat");

  // Show category data
  renderCategoryItems(category);
}

// Track the currently expanded card
let currentlyExpandedCard = null;

let cartItems = [];
const cartCounter = document.querySelector(".cart-counter");

// Function to update the cart counter
function updateCartCounter() {
  const totalItems = cartItems.reduce(
    (total, item) => total + item.quantity,
    0
  );
  cartCounter.textContent = totalItems;
}

// Function to show fly-to-cart animation
function showFlyToCartAnimation(startX, startY) {
  const flyElement = document.createElement("div");
  flyElement.classList.add("fly-to-cart");
  flyElement.style.left = `${startX}px`;
  flyElement.style.top = `${startY}px`;
  document.body.appendChild(flyElement);

  // Remove the element after the animation ends
  flyElement.addEventListener("animationend", () => {
    flyElement.remove();
  });
}

function renderCategoryItems(category) {
  categoryItemsContainer.style.opacity = "0";
  setTimeout(() => {
    categoryItemsContainer.innerHTML = "";

    Object?.values(categoryData[category])?.forEach((item) => {
      const card = document.createElement("div");
      card.classList.add("categoryCard");

      // Generate toppings HTML (radio buttons)
      const toppingsHTML =
        item?.toppings &&
        item?.toppings
          .map(
            (topping) => `
          <div class="topping-item">
            <div class="topping-item-name-container">
              <input type="radio" name="topping-${item.id}" id="topping-${topping.id}" class="topping-radio" value="${topping.title}">
              <label for="topping-${topping.id}" class="topping-name">${topping.title}</label>
            </div>
            <span class="topping-price">${topping.price} :-</span>
          </div>
        `
          )
          .join("");

      // Generate grams HTML (radio buttons)
      const gramsHTML =
        item?.grams &&
        item?.grams
          .map(
            (gram) => `
          <div class="topping-item">
            <div class="topping-item-name-container">
              <input type="radio" name="gram-${item.id}" id="gram-${gram.id}" class="topping-radio" value="${gram.title}">
              <label for="gram-${gram.id}" class="topping-name">${gram.title}</label>
            </div>
            <span class="topping-price">${gram.price} :-</span>
          </div>
        `
          )
          .join("");

      card.innerHTML = `
        <img src="${item.img}" alt="${item.title}">
        <h1>${item.title}</h1>
        <p>${item.location}</p>
        <div class="description" style="display: none;">
          <h2>Description</h2>
          <p>${item.description}</p>
        </div>
        <div class="notes" style="display: none;">
          <h2>Notes</h2>
          <ul>
            ${item?.notes?.map((note) => `<li>${note}</li>`).join("")}
          </ul>
        </div>
        <div class="serving-pricing" style="display: none;">
          <div class="details">
            <div>
              <h3>Serving</h3>
              <span>${item.serving}</span>
            </div>
            <div>
              <h3>Pricing</h3>
              <span>${item.pricing}</span>
            </div>
          </div>
          <!-- Toppings Section -->
          <div class="toppings">
            ${toppingsHTML ? "<h3>Toppings</h3>" : ""}
            ${toppingsHTML ? toppingsHTML : ""}
          </div>

          <!-- Grams Section -->
          <div class="toppings">
            ${
              gramsHTML
                ? "  <div class= 'gramContainer'><h3>Select Gram:</h3><h3>Price:</h3></div>        "
                : ""
            }
            ${gramsHTML ? gramsHTML : ""}
          </div>

          <!-- Quantity Button -->
          <div class="quantity-container">
            <button class="quantity-btn minus">-</button>
            <span class="quantity">00</span>
            <button class="quantity-btn plus">+</button>
          </div>
          <!-- Add to Cart Button -->
          <button class="add-to-cart">Add to Cart</button>
        </div>
      `;

      // Add click event to toggle expanded state
      card.addEventListener("click", () => {
        // Collapse the previously expanded card
        if (currentlyExpandedCard && currentlyExpandedCard !== card) {
          currentlyExpandedCard.classList.remove("expanded");
          currentlyExpandedCard.querySelector(".description").style.display =
            "none";
          currentlyExpandedCard.querySelector(".notes").style.display = "none";
          currentlyExpandedCard.querySelector(
            ".serving-pricing"
          ).style.display = "none";
        }

        // Toggle the clicked card
        card.classList.toggle("expanded");
        const description = card.querySelector(".description");
        const notes = card.querySelector(".notes");
        const servingPricing = card.querySelector(".serving-pricing");

        if (card.classList.contains("expanded")) {
          description.style.display = "block";
          notes.style.display = "block";
          servingPricing.style.display = "block";
          currentlyExpandedCard = card; // Update the currently expanded card
        } else {
          description.style.display = "none";
          notes.style.display = "none";
          servingPricing.style.display = "none";
          currentlyExpandedCard = null; // No card is expanded
        }
      });

      // Stop event propagation for radio button clicks
      card.querySelectorAll(".topping-radio, .gram-radio").forEach((radio) => {
        radio.addEventListener("click", (e) => {
          e.stopPropagation(); // Prevent the click event from bubbling up to the card
        });
      });

      // Quantity Button Logic
      const quantityElement = card.querySelector(".quantity");
      const minusButton = card.querySelector(".minus");
      const plusButton = card.querySelector(".plus");

      let quantity = 0;

      minusButton.addEventListener("click", (e) => {
        e.stopPropagation(); // Prevent card from collapsing
        if (quantity > 0) {
          quantity--;
          quantityElement.textContent = String(quantity).padStart(2, "0"); // Format as 00, 01, 02, etc.
        }
      });

      plusButton.addEventListener("click", (e) => {
        e.stopPropagation(); // Prevent card from collapsing
        quantity++;
        quantityElement.textContent = String(quantity).padStart(2, "0"); // Format as 00, 01, 02, etc.
      });

      // Add to Cart Button Logic
      // Add to Cart Button Logic
      const addToCartButton = card.querySelector(".add-to-cart");
      addToCartButton.addEventListener("click", (e) => {
        e.stopPropagation(); // Prevent card from collapsing

        // Get selected topping
        const selectedToppingRadio = card.querySelector(
          ".topping-radio:checked"
        );
        const selectedTopping = selectedToppingRadio
          ? {
              name: selectedToppingRadio.value,
              price: selectedToppingRadio
                .closest(".topping-item") // Traverse up to the parent .topping-item
                .querySelector(".topping-price")?.textContent, // Find the price element
            }
          : null;

        // Get selected gram
        const selectedGramRadio = card.querySelector(".gram-radio:checked");
        const selectedGram = selectedGramRadio
          ? {
              name: selectedGramRadio.value,
              price: selectedGramRadio
                .closest(".topping-item") // Traverse up to the parent .topping-item
                .querySelector(".topping-price")?.textContent, // Find the price element
            }
          : null;

        if (quantity > 0) {
          // Check if the item already exists in the cart
          const existingItemIndex = cartItems.findIndex(
            (cartItem) => cartItem.title === item.title
          );

          if (existingItemIndex !== -1) {
            // If the item exists, update its quantity
            cartItems[existingItemIndex].quantity += quantity;
          } else {
            // If the item does not exist, add it to the cart
            cartItems.push({
              title: item.title,
              quantity: quantity,
              price: item.pricing,
              topping: selectedTopping || null,
              gram: selectedGram || null,
              category: category || null,
            });
          }

          // Update cart counter
          updateCartCounter();

          // Show fly-to-cart animation
          const buttonRect = addToCartButton.getBoundingClientRect();
          showFlyToCartAnimation(buttonRect.left, buttonRect.top);

          // Log cart items for debugging
          console.log("Cart Items:", cartItems);
        } else {
          alert("Please select a quantity greater than 0.");
        }
      });

      categoryItemsContainer.appendChild(card);
    });

    categoryItemsContainer.style.opacity = "1"; // Fade in effect
  }, 300); // Delay to match transition
}
// Initialize categories and default category items
renderCategories();
setActiveCategory("Bowls");

function proceedToCheckout() {
  // Store the cartItems array in localStorage
  localStorage.setItem("cart", JSON.stringify(cartItems));

  // Redirect to informationDetails.html
  window.location.href = "informationDetails.html";
}

// cart
// DOM Elements
const cartContainer = document.querySelector(".cartcontainer");
const cartModal = document.getElementById("cartModal");
const cartItemsContainer = document.querySelector(".cartItemsContainer");
const cartCounter2 = document.querySelector(".cart-counter");

// Function to calculate the total price for an item
function calculateItemTotal(item) {
  const basePrice = parseFloat(item.price.replace(" SEK", ""));
  const toppingPrice = item.topping
    ? parseFloat(item.topping.price.replace(" SEK", ""))
    : 0;
  const gramPrice = item.gram
    ? parseFloat(item.gram.price.replace(" SEK", ""))
    : 0;
  return (basePrice + toppingPrice + gramPrice) * item.quantity;
}

// Function to render cart items
function renderCartItems() {
  let totalPrice = 0;

  // Clear existing content
  cartItemsContainer.innerHTML = "";

  // Check if the cart is empty
  if (cartItems.length === 0) {
    cartItemsContainer.innerHTML = `<h1 class="empty-cart-message">Your cart is empty</h1>`;
    // Remove the total and checkout section if it exists
    const totalSection = document.querySelector(".cartTotal");
    if (totalSection) {
      totalSection.remove();
    }
    return;
  }

  // Render each cart item
  cartItems.forEach((item, index) => {
    const itemTotal = calculateItemTotal(item);
    totalPrice += itemTotal;

    const cartItemHTML = `
      <div class="cartCont">
        <div class="cartContLeft">
          <img src="Assets/food2.jpg" alt="${item.title}">
          <div class="cartContLeftContent">
            <h3>${item.title}</h3>
            <h1 class="se">${item.category}</h1>
            <p>Quantity: ${item.quantity}</p>
          </div>
        </div>
        <div class="cartContRight">
          <p>Subtotal:</p>
          <span>${itemTotal.toFixed(2)} SEK</span>
          <div class="quantityBtn">
            <button onclick="decreaseQuantity(${index})">
            ${
              item?.quantity === 1
                ? "<img src='/Assets/recycle-bin.png' />"
                : "-"
            }

            </button>
            <span>${item.quantity}</span>
            <button onclick="increaseQuantity(${index})">+</button>
          </div>
        </div>
      </div>
    `;

    cartItemsContainer.innerHTML += cartItemHTML;
  });

  // Update total price
  const totalPriceElement = document.getElementById("totalPrice");
  if (totalPriceElement) {
    totalPriceElement.textContent = `${totalPrice.toFixed(2)} SEK`;
  } else {
    console.error("Total price element not found!");
  }

  // function to redirect and save the cart in local storage

  // Add the total and checkout section if it doesn't exist
  const totalSection = document.querySelector(".cartTotal");
  if (!totalSection) {
    const totalCheckoutHTML = `
      <div class="cartTotal">
        <p>
          <span>Total (Including fees & taxes):</span>
          <span id="totalPrice">${totalPrice.toFixed(2)} SEK</span>
        </p>
        <button class="checkoutBtn" onclick="proceedToCheckout()">Proceed to Checkout</button>
      </div>
    `;
    cartItemsContainer.insertAdjacentHTML("beforeend", totalCheckoutHTML);
  }

  // Update cart counter
  updateCartCounter();
}

// Function to increase quantity
function increaseQuantity(index) {
  if (cartItems[index]) {
    cartItems[index].quantity++;
    renderCartItems();
  }
}

// Function to decrease quantity
function decreaseQuantity(index) {
  if (cartItems[index]) {
    if (cartItems[index].quantity > 1) {
      cartItems[index].quantity--;
    } else {
      // If quantity is 1, remove the item from the cart
      cartItems.splice(index, 1);
    }
    renderCartItems();
  }
}

// Function to update the cart counter
function updateCartCounter() {
  const totalItems = cartItems.reduce(
    (total, item) => total + item.quantity,
    0
  );
  cartCounter2.textContent = totalItems;
}

// Function to open the cart modal
// function openCartModal() {
//   cartModal.style.display = "flex";
//   renderCartItems();
// }

// Function to close the cart modal
// function closeCartModal() {
//   cartModal.style.display = "none";
// }

// Event Listeners
cartContainer.addEventListener("click", openCartModal);
cartModal.addEventListener("click", (e) => {
  if (e.target === cartModal) {
    closeCartModal();
  }
});

// Initialize the cart counter
updateCartCounter();

const overlay = document.getElementById("overlay");

function openCartModal() {
  cartModal.style.display = "flex";
  overlay.style.display = "block";
  renderCartItems();
}

function closeCartModal() {
  cartModal.style.display = "none";
  overlay.style.display = "none";
}

cartContainer.addEventListener("click", openCartModal);
overlay.addEventListener("click", closeCartModal);
